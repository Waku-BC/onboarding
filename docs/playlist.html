<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Catalog Playlist — Implementation Gallery</title>

<style>
:root{
    --black:#000;
    --white:#fff;
    --yellow:#EFD900;
    --orange:#F76531;
    --purple:#AA6C7E;
    --blue:#4EA9D1;

    --fg: rgba(255,255,255,.92);
    --muted: rgba(255,255,255,.64);
    --border: rgba(255,255,255,.12);

    --max: 1160px;
    --h: 72px;

    --shadow: 0 12px 34px rgba(0,0,0,.35);
    --shadow-soft: 0 8px 22px rgba(0,0,0,.22);

    --ease: cubic-bezier(.2,.8,.2,1);
    --focus: 0 0 0 3px rgba(78,169,209,.35);
  }

  *{ box-sizing:border-box; }
  html,body{ height:100%; }
  body{
    margin:0;
    font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", "Hiragino Sans", "Apple Color Emoji","Segoe UI Emoji";
    color: var(--fg);
    background: var(--black);
    overflow-x:hidden;
  }
  a{ color:inherit; text-decoration:none; }
  button, input, select{ font:inherit; }

  .container{
    width:min(var(--max), calc(100% - 32px));
    margin:0 auto;
  }

  /* ===== Header (site style) ===== */
  .header{
    position:sticky; top:0; z-index:50;
    height:var(--h);
    display:flex; align-items:center;
    background: linear-gradient(to bottom, rgba(0,0,0,.78), rgba(0,0,0,.35));
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(255,255,255,.08);
    transition: background .25s var(--ease), box-shadow .25s var(--ease), border-color .25s var(--ease);
  }
  .header.is-scrolled{
    background: rgba(0,0,0,.84);
    box-shadow: var(--shadow-soft);
    border-bottom-color: rgba(255,255,255,.12);
  }
  .header-inner{
    width:min(var(--max), calc(100% - 32px));
    margin:0 auto;
    display:flex; align-items:center; justify-content:space-between;
    gap:14px;
  }
  .brand{ display:flex; align-items:center; gap:12px; min-width: 240px; }
  .logo-img{ width:34px; height:34px; object-fit:contain; display:block; }
  .brand-name{ display:flex; flex-direction:column; line-height:1.08; }
  .brand-name strong{ font-weight:800; letter-spacing:.6px; }
  .brand-name span{ font-size:12px; color: var(--muted); }

  .nav{
    display:flex; align-items:center; gap:2px;
    padding:6px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,.10);
    background: rgba(0,0,0,.25);
  }
  .nav a{
    padding: 10px 12px;
    border-radius: 999px;
    font-size: 14px;
    color: rgba(255,255,255,.78);
    transition: background .18s var(--ease), color .18s var(--ease), transform .18s var(--ease);
    position:relative;
    outline:none;
    white-space:nowrap;
  }
  .nav a:hover{ background: rgba(255,255,255,.08); color: rgba(255,255,255,.92); transform: translateY(-1px); }
  .nav a:focus-visible{ box-shadow: var(--focus); }
  .nav a[data-active="true"]{
    color: rgba(255,255,255,.95);
    background: rgba(255,255,255,.10);
  }
  .nav a[data-active="true"]::after{
    content:"";
    position:absolute;
    left:16px; right:16px; bottom:6px;
    height:2px; border-radius:999px;
    background: linear-gradient(90deg, var(--yellow), var(--orange), var(--purple), var(--blue));
    opacity:.95;
  }

  /* ===== Page ===== */
  .page{
    padding: 20px 0 64px;
    background:
      radial-gradient(1100px 620px at 10% -20%, rgba(239,217,0,.10), transparent 60%),
      radial-gradient(900px 520px at 90% -10%, rgba(78,169,209,.08), transparent 55%),
      var(--black);
  }

  .topbar{
    display:flex;
    align-items:flex-end;
    justify-content:space-between;
    gap: 14px;
    padding: 14px 0 16px;
    border-bottom: 1px solid rgba(255,255,255,.10);
  }
  .topbar h1{
    margin:0;
    font-size: clamp(18px, 2.1vw, 26px);
    letter-spacing:-.2px;
  }
  .topbar p{
    margin:8px 0 0;
    color: rgba(255,255,255,.70);
    font-size: 13px;
    line-height:1.65;
    max-width: 90ch;
  }

  /* Language switcher */
  .langbar{
    display:flex; align-items:center; gap:8px; flex-wrap:wrap;
    justify-content:flex-end;
  }
  .langbar label{ color: rgba(255,255,255,.72); font-size: 12px; }
  .select{
    display:inline-flex; align-items:center; gap:10px;
    height:40px; padding:0 12px;
    border-radius: 999px;
    border:1px solid rgba(255,255,255,.12);
    background: rgba(0,0,0,.25);
    color: rgba(255,255,255,.86);
    outline:none;
  }
  .hint{ color: rgba(255,255,255,.50); font-size: 12px; }

  /* ===== Layout grid ===== */
  .grid{
    display:grid;
    grid-template-columns: 1fr 360px;
    gap: 14px;
    align-items:start;
    padding-top: 16px;
  }

  /* Glass card */
  .card{
    border-radius: 22px;
    border: 1px solid rgba(255,255,255,.12);
    background: rgba(0,0,0,.34);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    box-shadow: var(--shadow-soft);
    overflow:hidden;
  }

  .player-wrap{
    position:relative;
    aspect-ratio: 16/9;
    background:#000;
    border-bottom: 1px solid rgba(255,255,255,.10);
  }
  .player-wrap .video-js,
  .player-wrap video-js{
    position:absolute !important;
    inset:0;
    width:100% !important;
    height:100% !important;
  }

  /* Media Info */
  .mediainfo{
    padding: 14px 16px 16px;
  }
  .mi-title{
    margin:0 0 6px;
    font-size: 16px;
    letter-spacing:-.1px;
  }
  .mi-desc{
    margin:0 0 12px;
    color: rgba(255,255,255,.70);
    font-size: 13px;
    line-height:1.7;
  }
  .mi-row{
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    align-items:center;
    font-size: 13px;
    color: rgba(255,255,255,.86);
    margin-top: 8px;
  }
  .mi-label{
    color: rgba(255,255,255,.58);
    font-weight:700;
    letter-spacing:.02em;
  }
  #mi-link a{
    color: rgba(255,255,255,.92);
    text-decoration:none;
    padding: 6px 10px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,.12);
    background: rgba(255,255,255,.06);
    transition: transform .18s var(--ease), background .18s var(--ease), border-color .18s var(--ease);
    outline:none;
    display:inline-flex;
    align-items:center;
    gap: 8px;
  }
  #mi-link a:hover{
    transform: translateY(-1px);
    background: rgba(255,255,255,.10);
    border-color: rgba(255,255,255,.18);
  }
  #mi-link a:focus-visible{ box-shadow: var(--focus); }
  #mi-link a::after{ content:"↗"; opacity:.8; }

  .tags{ display:flex; flex-wrap:wrap; gap:8px; }
  .tag{
    padding: 6px 10px;
    border:1px solid rgba(255,255,255,.12);
    border-radius: 999px;
    font-size: 12px;
    color: rgba(255,255,255,.72);
    background: rgba(0,0,0,.22);
    white-space:nowrap;
  }

  /* ===== Sidebar playlist ===== */
  .sidebar-head{
    padding: 14px 14px 10px;
    display:flex;
    align-items:flex-start;
    justify-content:space-between;
    gap:12px;
    border-bottom: 1px solid rgba(255,255,255,.10);
  }
  .sidebar-head h3{
    margin:0;
    font-size: 14px;
    letter-spacing:.2px;
  }
  .sidebar-head small{
    color: rgba(255,255,255,.55);
    font-size: 12px;
    line-height:1.4;
  }

  .list{
    display:flex;
    flex-direction:column;
    gap: 10px;
    max-height: calc(100vh - 240px);
    overflow:auto;
    padding: 12px;
  }

  .item{
    width:100%;
    text-align:left;
    display:flex;
    gap: 12px;
    padding: 10px;
    border-radius: 18px;
    cursor:pointer;

    border: 1px solid rgba(255,255,255,.12);
    background: rgba(255,255,255,.04);
    color: rgba(255,255,255,.90);

    transition: transform .18s var(--ease), background .18s var(--ease), border-color .18s var(--ease);
    outline:none;
  }
  .item:hover{
    transform: translateY(-1px);
    background: rgba(255,255,255,.08);
    border-color: rgba(255,255,255,.18);
  }
  .item:focus-visible{ box-shadow: var(--focus); }

  /* Selected item: gradient rail */
  .item.playing{
    border-color: rgba(255,255,255,.22);
    background: rgba(255,255,255,.10);
    position:relative;
  }
  .item.playing::before{
    content:"";
    position:absolute;
    left:12px; right:12px; top:8px;
    height:2px;
    border-radius:999px;
    background: linear-gradient(90deg, var(--yellow), var(--orange), var(--purple), var(--blue));
    opacity:.95;
  }

  .thumb{
    width: 120px;
    aspect-ratio: 16/9;
    border-radius: 14px;
    object-fit: cover;
    background: rgba(255,255,255,.06);
    border: 1px solid rgba(255,255,255,.08);
    flex: 0 0 auto;
  }
  .meta{
    display:flex;
    flex-direction:column;
    gap:6px;
    min-width: 0;
    padding-top: 2px;
  }
  .title{
    font-size: 13px;
    line-height:1.35;
    color: rgba(255,255,255,.92);
    display:-webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow:hidden;
  }
  .date{
    font-size: 11px;
    color: rgba(255,255,255,.55);
    letter-spacing:.06em;
  }

  /* Responsive */
  @media (max-width: 980px){
    .grid{ grid-template-columns: 1fr; }
    .list{ max-height:none; }
    .langbar{ justify-content:flex-start; }
    .nav{ display:none; } /* same behavior as your LP */
  }

  /* ===== Tag: Brightcove gradient border + glass ===== */
.tag{
  position: relative;
  padding: 6px 12px;
  border-radius: 999px;
  font-size: 12px;
  color: rgba(255,255,255,.88);
  background: rgba(0,0,0,.22);
  border: 1px solid rgba(255,255,255,.12);
  white-space: nowrap;

  /* little depth */
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.06);
}

/* gradient border (1px) */
.tag::before{
  content:"";
  position:absolute;
  inset:-1px;                 /* border の外側に1px */
  border-radius: inherit;
  background: linear-gradient(90deg, var(--yellow), var(--orange), var(--purple), var(--blue));
  opacity: .95;
  z-index:-1;
}

/* optional: subtle glow */
.tag{
  filter: drop-shadow(0 6px 16px rgba(0,0,0,.35));
}

/* ===== Shared Header/Nav Dropdown (overlay) ===== */
:root{
  --brand-grad: linear-gradient(90deg, var(--yellow), var(--orange), var(--purple), var(--blue));
}

.nav{ position:relative; }
.nav-dd{ position:relative; display:inline-flex; align-items:center; }

.nav-dd-btn{
  appearance:none;
  border:0;
  background:transparent;
  cursor:pointer;
  padding:10px 12px;
  border-radius:999px;
  font-size:14px;
  color:rgba(255,255,255,.78);
  transition:background .18s var(--ease), color .18s var(--ease), transform .18s var(--ease);
  position:relative;
  outline:none;
  white-space:nowrap;
  display:inline-flex;
  align-items:center;
  gap:10px;
}

.nav-dd-btn:hover{
  background:rgba(255,255,255,.08);
  color:rgba(255,255,255,.92);
  transform:translateY(-1px);
}
.nav-dd-btn:focus-visible{ box-shadow:var(--focus); }

.nav a:hover::after,
.nav-dd-btn:hover::after{
  content:"";
  position:absolute;
  left:16px; right:16px; bottom:6px;
  height:2px; border-radius:999px;
  background:var(--brand-grad);
  opacity:.95;
}

.nav-dd[data-open="true"] .nav-dd-btn,
.nav-dd[data-active="true"] .nav-dd-btn{
  color:rgba(255,255,255,.95);
  background:rgba(255,255,255,.10);
}
.nav-dd[data-open="true"] .nav-dd-btn::after,
.nav-dd[data-active="true"] .nav-dd-btn::after{
  content:"";
  position:absolute;
  left:16px; right:16px; bottom:6px;
  height:2px; border-radius:999px;
  background:var(--brand-grad);
  opacity:.95;
}

.chev{
  width:10px; height:10px;
  display:inline-block;
  border-right:2px solid rgba(255,255,255,.55);
  border-bottom:2px solid rgba(255,255,255,.55);
  transform:rotate(45deg);
  transition:transform .18s var(--ease), opacity .18s var(--ease);
  opacity:.9;
}
.nav-dd[data-open="true"] .chev{ transform:rotate(225deg); }

.nav-menu{
  position:absolute;
  top:calc(100% + 10px);
  left:0;
  min-width:220px;
  padding:8px;
  border-radius:16px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.72);
  backdrop-filter:blur(12px);
  -webkit-backdrop-filter:blur(12px);
  box-shadow:0 14px 40px rgba(0,0,0,.55), 0 0 0 1px rgba(255,255,255,.06) inset;
  display:none;
  z-index:80;
}
.nav-dd[data-open="true"] .nav-menu{ display:block; }

.nav-menu a{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  padding:10px 10px;
  border-radius:12px;
  color:rgba(255,255,255,.86);
  border:1px solid rgba(255,255,255,.08);
  background:rgba(255,255,255,.04);
  transition:transform .18s var(--ease), background .18s var(--ease), border-color .18s var(--ease), box-shadow .18s var(--ease);
  white-space:nowrap;
  position:relative;
}
.nav-menu a:hover{
  transform:translateY(-1px);
  background:
    linear-gradient(rgba(255,255,255,.06), rgba(255,255,255,.06)) padding-box,
    var(--brand-grad) border-box;
  border:1px solid transparent;
  box-shadow:0 8px 22px rgba(0,0,0,.35), 0 0 18px rgba(247,101,49,.18);
}
.nav-menu a[data-active="true"]{
  background:
    linear-gradient(rgba(255,255,255,.08), rgba(255,255,255,.08)) padding-box,
    var(--brand-grad) border-box;
  border:1px solid transparent;
}
.nav-menu a[data-active="true"]::after{
  content:"";
  position:absolute;
  left:12px; right:12px; bottom:7px;
  height:2px; border-radius:999px;
  background:var(--brand-grad);
  opacity:.95;
}

@media (max-width:760px){
  .nav{ flex-wrap:wrap; justify-content:center; }
  .nav-menu{ left:50%; transform:translateX(-50%); }
}

/* ===== Footer ===== */
.footer{
  position:relative;
  border-top: 1px solid rgba(255,255,255,.10);
  background:
    radial-gradient(900px 420px at 15% 120%, rgba(239,217,0,.10), transparent 60%),
    radial-gradient(860px 420px at 85% 120%, rgba(78,169,209,.10), transparent 60%),
    linear-gradient(to top, rgba(255,255,255,.03), rgba(0,0,0,0) 45%),
    var(--black);
  overflow:hidden;
}

/* top accent line */
.footer::before{
  content:"";
  position:absolute;
  left:0; right:0; top:0;
  height:1px;
  background: linear-gradient(90deg, var(--yellow), var(--orange), var(--purple), var(--blue));
  opacity:.9;
}

/* subtle noise-ish sheen */
.footer::after{
  content:"";
  position:absolute;
  inset:-2px;
  background:
    radial-gradient(900px 520px at 50% 130%, rgba(255,255,255,.05), transparent 60%);
  pointer-events:none;
  opacity:.6;
}

.footer-inner{
  position:relative;
  z-index:1;
  padding: 40px 0 22px;
  display:block; /* reset legacy grid */
}

.footer-top{
  display:grid;
  grid-template-columns: minmax(320px, 1.3fr) minmax(260px, 1fr);
  gap: 18px;
  align-items:start;
}

.footer-brand{
  display:flex;
  align-items:flex-start;
  gap:14px;
  text-align:left;
  max-width: 560px;
}

.footer-logo{
  width:34px;
  height:34px;
  object-fit:contain;
  flex:0 0 auto;
  opacity:.92;
}

.footer-brand h3{
  margin:0 0 4px 0;
  font-size:15px;
  font-weight:600;
  letter-spacing:.2px;
}

.footer-brand p{
  margin:0;
  font-size:13px;
  line-height:1.5;
  color:rgba(255,255,255,.65);
}

.footer-col h4{
  margin: 0 0 10px;
  font-size: 12px;
  letter-spacing:.35px;
  text-transform: uppercase;
  color: rgba(255,255,255,.78);
}

.footer-links{
  display:grid;
  grid-auto-flow: column;
  grid-template-rows: repeat(3, auto);
  gap: 8px 14px;
  align-content:start;
}

@media (max-width: 640px){
  .footer-links{
    grid-auto-flow: row;
    grid-template-rows: none;
  }
}

.footer-links a{
  color: rgba(255,255,255,.70);
  font-size: 13px;
  line-height:1.4;
  display:inline-flex;
  align-items:center;
  gap: 8px;
  width: fit-content;
  padding: 6px 8px;
  border-radius: 10px;
  transition: background .18s var(--ease), color .18s var(--ease), transform .18s var(--ease);
  outline:none;
}

.footer-links a:hover{
  color: rgba(255,255,255,.92);
  background: rgba(255,255,255,.06);
  transform: translateY(-1px);
}

.footer-links a:focus-visible{ box-shadow: var(--focus); }

.footer-links .hint{
  opacity:.75;
  font-size: 12px;
}

.footer-divider{
  margin: 22px 0 14px;
  height:1px;
  background: rgba(255,255,255,.10);
}

.footer-bottom{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 12px;
  flex-wrap:wrap;
  color: rgba(255,255,255,.55);
  font-size: 12px;
  border-top:none; /* reset legacy */
  padding: 0; /* divider handles spacing */
}

.footer-badges{
  display:flex;
  align-items:center;
  gap: 8px;
  flex-wrap:wrap;
}

.footer-pill{
  display:inline-flex;
  align-items:center;
  gap: 8px;
  padding: 6px 10px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.05);
  color: rgba(255,255,255,.70);
}

/* responsive */
@media (max-width: 980px){
  .footer-top{ grid-template-columns: 1fr 1fr; }
}
@media (max-width: 640px){
  .footer-inner{ padding: 34px 0 20px; }
  .footer-top{ grid-template-columns: 1fr; }
  .footer-bottom{ flex-direction:column; align-items:flex-start; }
}

@media (max-width: 860px){
  .footer-top{ grid-template-columns: 1fr; }
}

</style>
</head>

<body>
  <header class="header" id="siteHeader">
    <div class="header-inner">
      <a class="brand" href="index.html">
        <img class="logo-img" src="https://solutions.brightcove.com/wmatsuo/Blogo.svg" alt="Brightcove Logo" />
        <div class="brand-name">
          <strong>BRIGHTCOVE</strong>
          <span>Onboarding Engagement Manager</span>
          <span>Implementation Gallery</span>
        </div>
      </a>
  
      <nav class="nav" aria-label="Primary">
        <a href="index.html" data-nav="home">Home</a>
        <a href="media.html" data-nav="media">Media</a>
        <a href="player.html" data-nav="player">Player</a>

        <div class="nav-dd" data-nav-group="catalog">
          <button class="nav-dd-btn" type="button" aria-haspopup="menu" aria-expanded="false">
            Catalog <span class="chev" aria-hidden="true"></span>
          </button>
          <div class="nav-menu" role="menu" aria-label="Catalog menu">
            <a role="menuitem" href="api.html" data-nav="api">Catalog API</a>
            <a role="menuitem" href="playlist.html" data-nav="playlist">Playlist</a>
            <a role="menuitem" href="grid.html" data-nav="grid">Grid</a>
          </div>
        </div>

        <div class="nav-dd" data-nav-group="advertising">
          <button class="nav-dd-btn" type="button" aria-haspopup="menu" aria-expanded="false">
            Advertising <span class="chev" aria-hidden="true"></span>
          </button>
          <div class="nav-menu" role="menu" aria-label="Advertising menu">
            <a role="menuitem" href="ad.html" data-nav="csai">CSAI</a>
            <a role="menuitem" href="ssai.html" data-nav="ssai">SSAI</a>
          </div>
        </div>

        <a href="ga4_gallery.html" data-nav="ga">Google Analytics</a>
      </nav>
    </div>
  </header>

  <main class="page">
    <div class="container">
      <div class="topbar">
        <div>
          <h1>Catalog Playlist</h1>
          <p>
            This page fetches a playlist via the Catalog API and renders a sidebar playlist.
            Media info supports language variants when provided in metadata.
          </p>
        </div>

        <div class="langbar" role="group" aria-label="Language switcher">
          <label for="lang">Language</label>
          <select id="lang" class="select">
            <option value="en">English</option>
            <option value="ja">日本語</option>
          </select>
          <span class="hint" id="lang-hint"></span>
        </div>
      </div>

      <div class="grid">
        <!-- Left: Player + Media Info -->
        <div class="card">
          <div class="player-wrap" aria-label="Brightcove player">
            <video-js
              id="bcPlayer"
              data-account="6243204265001"
              data-player="69IXNadf9"
              data-embed="default"
              controls
              playsinline
              class="vjs-fluid vjs-16-9">
            </video-js>
          </div>

          <section id="mi" class="mediainfo" aria-live="polite" hidden>
            <h2 id="mi-title" class="mi-title"></h2>
            <p  id="mi-desc"  class="mi-desc"></p>

            <div class="mi-row">
              <span class="mi-label" data-i18n="link-label">Related link</span>
              <span id="mi-link">—</span>
            </div>

            <div class="mi-row" style="margin-top:10px;">
              <span class="mi-label" data-i18n="tags-label">Tags</span>
              <div id="mi-tags" class="tags"></div>
            </div>
          </section>
        </div>

        <!-- Right: Sidebar playlist -->
        <aside class="card" aria-label="Playlist sidebar">
          <div class="sidebar-head">
            <div>
              <h3>More videos</h3>
              <small>From the same playlist</small>
            </div>
            <span class="tag" id="countPill">—</span>
          </div>
          <div id="playlist" class="list" role="list" aria-label="More videos"></div>
        </aside>
      </div>
    </div>
  </main>

  <!-- Brightcove runtime -->
  <script src="https://players.brightcove.net/6243204265001/69IXNadf9_default/index.min.js"></script>

  <script>
  (function(){
    // ===== Brightcove settings =====
    const ACCOUNT_ID  = '6243204265001';
    const PLAYER_ID   = '69IXNadf9';

    // ✅ IMPORTANT: set to your PLAYLIST ID (not a video id)
    const PLAYLIST_ID = '1849995119852741477';
    // ==============================

    // Header elevation
    const header = document.getElementById('siteHeader');
    const onScroll = () => header.classList.toggle('is-scrolled', window.scrollY > 6);
    onScroll();
    window.addEventListener('scroll', onScroll, { passive: true });

    const player = videojs('bcPlayer');
    const $list  = document.getElementById('playlist');
    const $count = document.getElementById('countPill');

    // --- Media Info DOM refs
    const $miWrap  = document.getElementById('mi');
    const $miTitle = document.getElementById('mi-title');
    const $miDesc  = document.getElementById('mi-desc');
    const $miLink  = document.getElementById('mi-link');
    const $miTags  = document.getElementById('mi-tags');

    // --- i18n labels
    const I18N = {
      en: { link: 'Related link', tags: 'Tags' },
      ja: { link: '関連リンク', tags: 'タグ' }
    };
    function toShort(code){ return (code||'').toLowerCase().split('-')[0]; }
    function normalizeLang(code){
      const c = (code||'').toLowerCase();
      if(!c) return 'en';
      const s = toShort(c);
      if(['ja','en'].includes(s)) return s;
      return 'en';
    }
    function applyI18nLabels(lang){
      const dict = I18N[lang] || I18N.en;
      const linkEl = document.querySelector('[data-i18n="link-label"]');
      const tagsEl = document.querySelector('[data-i18n="tags-label"]');
      if(linkEl) linkEl.textContent = dict.link;
      if(tagsEl) tagsEl.textContent = dict.tags;
    }

    // --- Language decision (URL ?lang > <html lang> > navigator.language)
    const urlLang = new URLSearchParams(location.search).get('lang');
    const docLang = (document.documentElement.lang || '').trim();
    const navLang = (navigator.language || '').trim();
    const preferred = (urlLang || docLang || navLang || 'en').toLowerCase();

    let currentLang = normalizeLang(preferred);
    const $langSel  = document.getElementById('lang');
    const $langHint = document.getElementById('lang-hint');
    if($langSel) $langSel.value = currentLang;
    if($langHint) $langHint.textContent = '(auto: ' + preferred + ')';
    document.documentElement.lang = currentLang;
    applyI18nLabels(currentLang);

    // ======== Media Info helpers (same logic, slightly hardened) ========
    function pickVariant(mi, wanted){
      mi = mi || {};
      const vs = (mi.variants && Array.isArray(mi.variants)) ? mi.variants : [];
      if(!vs.length) return null;
      const wantedFull  = (wanted || '').toLowerCase();
      const wantedShort = toShort(wantedFull);
      return vs.find(v => (v.language||'').toLowerCase() === wantedFull)
          || vs.find(v => toShort(v.language) === wantedShort)
          || null;
    }

    function normalizeHref(raw){
      const s = String(raw || '').trim();
      if(!s) return '';
      if(/^https?:\/\//i.test(s)) return s;
      if(/^(mailto:|tel:)/i.test(s)) return s;
      return 'https://' + s.replace(/^\/+/, '');
    }

    // expects: link: { url, text }
    function extractRelatedLink(obj){
      obj = obj || {};
      const link = obj.link;
      if(link && typeof link === 'object'){
        const href = normalizeHref(link.url);
        const text = String(link.text || '').trim();
        if(href && text) return { href, text };
      }
      return null;
    }

    function buildDisplayData(mi, lang){
      mi = mi || {};
      const v = pickVariant(mi, lang) || {};
      const title = v.name || mi.name || '';
      const desc  = v.description || v.long_description || mi.description || mi.long_description || '';
      const tags  = Array.isArray(mi.tags) ? mi.tags : (Array.isArray(v.tags) ? v.tags : []);
      const link  = extractRelatedLink(v) || extractRelatedLink(mi);
      return { title, desc, tags, link };
    }

    function renderMediaInfo(mi, lang){
      const d = buildDisplayData(mi, lang);

      $miTitle.textContent = d.title || '';
      $miDesc.textContent  = d.desc || '';

      // related link
      $miLink.innerHTML = '—';
      if(d.link && d.link.href){
        const a = document.createElement('a');
        a.href = d.link.href;
        a.textContent = d.link.text;
        a.target = '_blank';
        a.rel = 'noopener noreferrer';
        $miLink.innerHTML = '';
        $miLink.appendChild(a);
      }

      // tags
      $miTags.innerHTML = '';
      (d.tags || []).forEach(t => {
        const chip = document.createElement('span');
        chip.className = 'tag';
        chip.textContent = t;
        $miTags.appendChild(chip);
      });

      const has =
        (d.title && d.title.trim()) ||
        (d.desc  && d.desc.trim())  ||
        (d.link && d.link.href)     ||
        (d.tags && d.tags.length > 0);

      $miWrap.hidden = !has;
    }

    // ======== Playlist / Player wiring ========
    let items = [];
    let currentVideoId = null;

    player.ready(function(){
      if(!PLAYLIST_ID || PLAYLIST_ID.includes('YOUR_')){
        console.warn('Set PLAYLIST_ID to your playlist id.');
        $list.innerHTML = '<div style="padding:12px;color:rgba(255,255,255,.65);font-size:13px;">Set <code>PLAYLIST_ID</code> to a valid Brightcove playlist id.</div>';
        return;
      }

      player.catalog.getPlaylist(PLAYLIST_ID, function(err, playlist){
        if(err){ console.error('getPlaylist error:', err); return; }

        // Brightcove returns playlist object with .videos
        items = (playlist && playlist.videos) ? playlist.videos : (Array.isArray(playlist) ? playlist : []);
        $count.textContent = items.length ? (items.length + ' items') : '—';

        renderList(items);

        // Load first item if nothing loaded
        if(items.length && !(player.mediainfo && player.mediainfo.id)){
          load(items[0]);
        }
      });
    });

    function load(videoObj){
      player.catalog.load(videoObj);
      const p = player.play();
      if(p && typeof p.catch === 'function'){
        p.catch(function(){ /* user gesture required: ignore */ });
      }
    }

    function updatePlayingHighlight(){
      const cards = $list.querySelectorAll('.item');
      cards.forEach(el => {
        const vid = el.getAttribute('data-video-id');
        const on = (vid === currentVideoId);
        el.classList.toggle('playing', on);
        el.setAttribute('aria-current', on ? 'true' : 'false');
      });
    }

    function redraw(){
      currentVideoId = (player.mediainfo && String(player.mediainfo.id)) || null;
      renderMediaInfo(player.mediainfo || {}, currentLang);
      updatePlayingHighlight();
    }
    player.on('loadstart', redraw);
    player.on('loadedmetadata', redraw);
    player.on('playlistitem', redraw);

    function renderList(videos){
      $list.innerHTML = '';
      videos.forEach(v => {
        const id = String(v.id);
        const item = document.createElement('button');
        item.className = 'item';
        item.type = 'button';
        item.setAttribute('role','listitem');
        item.setAttribute('data-video-id', id);
        item.addEventListener('click', () => load(v));

        const img = document.createElement('img');
        img.className = 'thumb';
        img.alt = v.name ? ('Thumbnail: ' + v.name) : 'thumbnail';
        img.loading = 'lazy';
        img.src = (v.thumbnail || v.poster) ? (v.thumbnail || v.poster) : '';

        const meta  = document.createElement('div'); meta.className='meta';
        const title = document.createElement('div'); title.className='title'; title.textContent = v.name || '';
        const date  = document.createElement('div'); date.className='date';  date.textContent = formatDate(v.published_at || v.updated_at || v.created_at);

        meta.appendChild(title);
        meta.appendChild(date);

        item.appendChild(img);
        item.appendChild(meta);

        $list.appendChild(item);
      });
      updatePlayingHighlight();
    }

    function formatDate(iso){
      if(!iso) return '';
      const d = new Date(iso);
      if(isNaN(d)) return '';
      return d.toLocaleDateString(undefined,{ day:'2-digit', month:'short', year:'numeric' }).toUpperCase();
    }

    // Language change
    if($langSel){
      $langSel.addEventListener('change', (e) => {
        currentLang = normalizeLang(e.target.value);
        document.documentElement.lang = currentLang;
        applyI18nLabels(currentLang);
        renderMediaInfo(player.mediainfo || {}, currentLang);
      });
    }
  })();
  </script>
<footer class="footer" aria-label="Site footer">
  <div class="container footer-inner">
    <div class="footer-top">
      <div class="footer-brand">
        <img class="footer-logo" src="https://solutions.brightcove.com/wmatsuo/Blogo.svg" alt="" aria-hidden="true">
        <div>
          <h3>Onboarding Engagement Manager</h3>
          <p>
            A lightweight Brightcove onboarding/demo gallery—player patterns, catalog surfaces, and advertising inspectors.
          </p>
        </div>
      </div>

      <div class="footer-col">
        <h4>Explore</h4>
        <nav class="footer-links" aria-label="Footer navigation">
          <a href="index.html"><span aria-hidden="true">↗</span> Home</a>
          <a href="media.html"><span aria-hidden="true">↗</span> Media</a>
          <a href="player.html"><span aria-hidden="true">↗</span> Player showcase</a>
          <a href="api.html"><span aria-hidden="true">↗</span> Catalog API</a>
          <a href="playlist.html"><span aria-hidden="true">↗</span> Playlist</a>
          <a href="grid.html"><span aria-hidden="true">↗</span> Grid</a>
          <a href="ad.html"><span aria-hidden="true">↗</span> Advertising (CSAI)</a>
          <a href="ssai.html"><span aria-hidden="true">↗</span> Advertising (SSAI)</a>
          <a href="ga4_gallery.html"><span aria-hidden="true">↗</span> Google Analytics</a>
        </nav>
      </div>
    </div>

    <div class="footer-divider" role="separator"></div>

    <div class="footer-bottom">
      <div>© <span id="footerYear"></span> Brightcove • Waku Matsuo</div>

      <div class="footer-badges" aria-label="Badges">
        <span class="footer-pill">Docs-aligned</span>
        <span class="footer-pill">Implementation-first</span>
        <span class="footer-pill">Brightcove Player</span>
      </div>
    </div>
  </div>
</footer>
<script>
(() => {
  // Header elevation
  const header = document.getElementById('siteHeader');
  if (header) {
    const onScroll = () => header.classList.toggle('is-scrolled', window.scrollY > 6);
    onScroll();
    window.addEventListener('scroll', onScroll, { passive: true });
  }

  // Dropdown open/close
  const dds = Array.from(document.querySelectorAll('.nav-dd'));
  const closeAll = () => dds.forEach(dd => {
    dd.dataset.open = "false";
    const btn = dd.querySelector('.nav-dd-btn');
    if (btn) btn.setAttribute('aria-expanded', 'false');
  });
  const openOne = (dd) => {
    closeAll();
    dd.dataset.open = "true";
    const btn = dd.querySelector('.nav-dd-btn');
    if (btn) btn.setAttribute('aria-expanded', 'true');
  };

  dds.forEach(dd => {
    const btn = dd.querySelector('.nav-dd-btn');
    if (!btn) return;
    dd.dataset.open = "false";
    btn.addEventListener('click', (e) => {
      e.preventDefault();
      (dd.dataset.open === "true") ? closeAll() : openOne(dd);
    });
  });

  document.addEventListener('click', (e) => {
    if (!e.target.closest('.nav-dd')) closeAll();
  });
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') closeAll();
  });

  // Active state (by pathname)
  const path = (location.pathname.split('/').pop() || '').toLowerCase();

  // Reset active markers
  document.querySelectorAll('.nav [data-active]').forEach(a => a.removeAttribute('data-active'));
  document.querySelectorAll('.nav-dd').forEach(dd => dd.removeAttribute('data-active'));

  const pageToNav = new Map([
    ['index.html', 'home'],
    ['playershow.html', 'player'],
    ['ga4_gallery.html', 'ga'],
    ['catalog.html', 'api'],
    ['media.html', 'media'],
    ['player.html', 'player'],
    ['api.html', 'api'],
    ['playlist.html', 'playlist'],
    ['grid.html', 'grid'],
    ['ad.html', 'csai'],
    ['ssai.html', 'ssai'],
    ['ga.html', 'ga'],
  ]);

  const key = pageToNav.get(path);
  if (!key) return;

  // Direct links
  const direct = document.querySelector(`.nav > a[data-nav="${key}"]`);
  if (direct) direct.dataset.active = "true";

  // Dropdown items + parent highlight
  const item = document.querySelector(`.nav-menu a[data-nav="${key}"]`);
  if (item) {
    item.dataset.active = "true";
    const group = item.closest('.nav-dd');
    if (group) group.dataset.active = "true";
  }
})();
</script>

<script>
(() => {
  const y = document.getElementById('footerYear');
  if (y) y.textContent = String(new Date().getFullYear());
})();
</script>
</body>
</html>
